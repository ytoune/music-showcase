(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{5283:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return Ue}});var n=r(1720),u=r(6515),o=r(1173),i=r(8510),c=r(9127),a=new u.X(0),s=function(e){return a.next(e)},l=Number("u">typeof localStorage&&localStorage.getItem("my:cursor"))||0,f=a.pipe((0,o.R)((function(e,t){return e+t}),l),(0,i.d)(1)),p=a.pipe((0,c.U)((function(e){return!e})),(0,i.d)(1));s(1),s(-1);var d=r(5944),m=new(r(2649).x),v=function(e){m.next(e)},b=m.pipe((0,i.d)(1)),h=r(3321),y=function(){var e=(0,n.useRef)(null),t=(0,n.useCallback)((function(){null!=e.current&&e.current.click()}),[]),r=(0,n.useCallback)((function(e){e.target.files&&Array.from(e.target.files).map(v)}),[]);return(0,d.BX)(d.HY,{children:[(0,d.tZ)(h.Z,{onClick:t,variant:"outlined",children:"upload zip file"}),(0,d.tZ)("input",{type:"file",ref:e,style:{display:"none"},onChange:r})]})},w=r(4978),Z=r(6174),g=r(266),x=r(809),O=r.n(x),k=r(5733),E=r(9711),j=r(37),P=r(983),C=r(2809),D="RESET",S="ADD",N="DONE",_=new u.X(D),A=function(e){return _.next(e)},R=_.pipe((0,o.R)((function(e,t){var r=(0,E.Z)(e,2),n=r[0],u=r[1];switch(t){case D:return[n-u,0];case S:return[n,u+1];case N:return[n+1,u];default:return[n,u]}}),[0,0]),(0,c.U)((function(e){var t=(0,E.Z)(e,2),r=t[0],n=t[1];return{done:Math.max(0,r),total:n,progress:n?Math.max(0,r)/n:0}})),(0,i.d)(1));function U(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function X(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?U(Object(r),!0).forEach((function(t){(0,C.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):U(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var B=function(){var e=(0,g.Z)(O().mark((function e(t){var n,u,o,i,c;return O().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return A(S),A(S),e.next=4,Promise.all([r.e(463),r.e(726)]).then(r.bind(r,2463));case 4:return n=e.sent,u=n.parseBlob,o=t.name,e.next=9,t.async("blob");case 9:return i=e.sent,A(N),e.next=13,u(i);case 13:return c=e.sent,A(N),e.abrupt("return",X(X({name:o},c),{},{blob:i}));case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),L=r(1164),T=function(e){return e.trim().split(/\r?\n/gi).map((function(e){return e.trim()})).filter(Boolean).map((function(e){var t,r,n,u=e.split(/\t/gi).map((function(e){return e.trim()}));return{filename:null===(t=u[0])||void 0===t?void 0:t.trim(),start:null===(r=u[1])||void 0===r?void 0:r.trim(),end:null===(n=u[2])||void 0===n?void 0:n.trim()}}))},I=["name"];function M(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function z(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?M(Object(r),!0).forEach((function(t){(0,C.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):M(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var F=function(){var e=(0,g.Z)(O().mark((function e(t){var r;return O().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return A(S),e.t0=T,e.next=4,t.async("text");case 4:return e.t1=e.sent,r=(0,e.t0)(e.t1).map(q).filter(Y).reduce(G,{}),A(N),e.abrupt("return",H(r));case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),H=function(e){return function(t){return t.map((function(t){var r=t.name,n=(0,L.Z)(t,I);return z({name:r,preview:e[r]||{}},n)}))}},Y=function(e){return!!e.filename&&Number.isFinite(e.start)&&Number.isFinite(e.end)},q=function(e){var t=e.filename,r=e.start,n=e.end;return{filename:t,start:$(r),end:$(n)}},$=function(e){if(e){var t=/^(\d+):(\d+)(\.\d+|)$/.exec(e);if(t){var r=t.slice(1).map(J),n=(0,E.Z)(r,3);return 60*n[0]+n[1]+n[2]}}},G=function(e,t){var r=t.filename,n=t.start,u=t.end;return z(z({},e),{},(0,C.Z)({},r,{start:n,end:u}))},J=function(e){return Number(e)||0},K=function(){var e=(0,g.Z)(O().mark((function e(t){var r;return O().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.dir){e.next=2;break}return e.abrupt("return",[0,null]);case 2:if(e.prev=2,!(r=(0,P.lookup)(t.name))||"audio/"!==r.slice(0,6)){e.next=11;break}return e.t0=Q,e.next=8,B(t);case 8:return e.t1=e.sent,e.t2=(0,e.t0)(e.t1),e.abrupt("return",[1,e.t2]);case 11:if("text/tab-separated-values"!==r){e.next=16;break}return e.next=14,F(t);case 14:return e.t3=e.sent,e.abrupt("return",[9,e.t3]);case 16:return e.abrupt("return",[0,null]);case 19:if(e.prev=19,e.t4=e.catch(2),!/(^|\/)\./.test(t.name)){e.next=23;break}return e.abrupt("return",[0,null]);case 23:throw e.t4;case 24:case"end":return e.stop()}}),e,null,[[2,19]])})));return function(t){return e.apply(this,arguments)}}(),Q=function(e){return function(t){return[].concat((0,j.Z)(t),[e])}},V=function(e,t){var r=(0,E.Z)(t,2),n=(r[0],r[1]);return"function"===typeof n?n(e):e},W=function(e,t){return(0,E.Z)(e,1)[0]-(0,E.Z)(t,1)[0]},ee=function(){var e=(0,g.Z)(O().mark((function e(t){var n,u,o,i;return O().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return A(D),A(S),e.next=4,r.e(456).then(r.t.bind(r,5456,23));case 4:return n=e.sent,u=n.convert,e.next=8,(0,k.loadAsync)(t,{decodeFileName:function(e){return u(e,{to:"UNICODE",from:"AUTO",type:"string"})}});case 8:return o=e.sent,A(N),i=[],o.forEach((function(e,t){return i.push(t)})),e.next=14,Promise.all(i.map(K));case 14:return e.abrupt("return",e.sent.sort(W).reduce(V,[]));case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),te=r(7072),re=r(5997),ne="files",ue=function(){function e(t,r){(0,te.Z)(this,e),this.open=t,this.key=r}return(0,re.Z)(e,[{key:"read",value:function(){var e=this;return oe(this.open,"readonly",(function(t){return new Promise((function(r,n){var u=t.get(e.key);u.onerror=n,u.onsuccess=function(){var e;r(null===(e=u.result)||void 0===e?void 0:e.val)}}))}))}},{key:"write",value:function(e){var t=this;return oe(this.open,"readwrite",(function(r){return new Promise((function(n,u){var o=r.put({ssn:t.key,val:e});o.onerror=u,o.onsuccess=function(){n(o.result)}}))}))}}]),e}(),oe=function(){var e=(0,g.Z)(O().mark((function e(t,r,n){var u,o;return O().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t();case 2:return u=e.sent,e.prev=3,o=u.transaction([ne],r).objectStore(ne),e.next=7,n(o);case 7:return e.abrupt("return",e.sent);case 8:return e.prev=8,u.close(),e.finish(8);case 11:case"end":return e.stop()}}),e,null,[[3,,8,11]])})));return function(t,r,n){return e.apply(this,arguments)}}(),ie=r(2817),ce=r(9293),ae=new ue((function(){return new Promise((function(e,t){try{var r=indexedDB.open("app",1);r.onerror=t,r.onupgradeneeded=function(e){e.target.result.createObjectStore(ne,{keyPath:"ssn"})},r.onsuccess=function(t){var r=t.target.result;e(r)}}catch(n){t(n)}}))}),"files"),se=new ce.y((function(e){var t=!0;return ae.read().catch((function(e){console.error(e)})).then((function(r){r&&t&&(e.next(r),setTimeout(le,10)),e.complete()})),{unsubscribe:function(){t=!1}}})),le=function(){var e=document.body,t=document.createElement("div");t.style.position="fixed",t.style.top="0",t.style.bottom="0",t.style.right="0",t.style.left="0",t.style.zIndex="99999999",t.addEventListener("click",(function(){var r;e.removeChild(t),null===(r=e.querySelector("audio"))||void 0===r||r.play()})),e.appendChild(t)},fe="LOAD_CACHE",pe=b.pipe((0,w.w)(ee),(0,c.U)((function(e){return e.slice().sort((function(e,t){return e.name.localeCompare(t.name,[],{numeric:!0})}))})),(0,Z.O)(fe),(0,w.w)((function(e){return fe===e?se:function(e){return ae.write(e).catch((function(e){console.error(e)})),(0,ie.of)(e)}(e)})),(0,i.d)(1)),de=function(e){var t=e.start,r=e.end,u=e.src,o=e.onEnded,i=(0,n.useRef)(null);(0,n.useEffect)((function(){var e=p.subscribe((function(e){return e&&void(null!=i.current&&(i.current.currentTime=0))})),t=Number(localStorage.getItem("my:volume"));return i.current&&t&&(i.current.volume=t),function(){return e.unsubscribe()}}),[]);var c=(0,n.useCallback)((function(e){var n=e.target,u=e.target.currentTime,o="number"===typeof t?t:0;switch(!0){case"number"!==typeof u:case"number"===typeof r&&r<o:return;case u<o:case r&&r<=u:return void(n.currentTime=o)}}),[t,r]),a=(0,n.useCallback)((function(){return o((function(){null!=i.current&&i.current.play()}))}),[o]);return(0,d.tZ)("audio",{src:u,ref:i,controls:!0,autoPlay:!0,onEnded:a,onTimeUpdate:c})},me=r(5113),ve=r(8905),be=r(7275),he=r(8462),ye=r(6795),we=(0,ye.Z)({root:{textAlign:"center",padding:"80px 30px"}})(me.Z),Ze=function(e){var t=e.files;if(!t.length)return(0,d.BX)(we,{children:["\u4e0b\u306e\u30dc\u30bf\u30f3\u304b\u3089",(0,d.tZ)("br",{}),"mp3 \u3092 zip \u3067",(0,d.tZ)("br",{}),"\u307e\u3068\u3081\u3066\u3042\u3052\u3066\u304f\u3060\u3055\u3044\u3002",(0,d.tZ)("br",{}),(0,d.tZ)("a",{href:"https://github.com/ytoune/music-showcase/blob/master/README.md",target:"_blank",rel:"noopener noreferrer",children:"\u4f7f\u3044\u65b9"})]});var r=t.map((function(e,t){var r=e.name,n=e.common,u=n.artists,o=n.title;return(0,d.tZ)(ve.ZP,{button:!0,onClick:function(){return s(t)},selected:!t,children:(0,d.tZ)(be.Z,{primary:o||r,secondary:u&&u.join(", ")})},r)}));return r.unshift.apply(r,(0,j.Z)(r.splice(-1))),(0,d.tZ)(he.Z,{children:r})},ge=function(e){var t=e.show,r=e.children;return(0,d.tZ)(d.HY,{children:t?r:null})},xe=r(3365),Oe=r(8452),ke=r(8815),Ee=r(1265),je={"@global":{body:{margin:0,padding:0,"& #screen":{"&::after":{display:"block",content:'""',overflow:"hidden",clear:"both"},margin:0,padding:0,"& > *":{width:"100%"},"& main":{position:"fixed",overflow:"hidden",left:10,right:10,top:30,bottom:30,zIndex:"1"},"& header, & footer":{position:"fixed",left:0,right:0,margin:"0 auto",textAlign:"center",zIndex:"10"},"& header":{top:0},"& footer":{bottom:0,padding:"5px 20px 10px"}}}}},Pe=(0,Ee.Z)({palette:{primary:{main:"#000"}}}),Ce=(0,Ee.Z)({palette:{mode:"dark",primary:{main:"#fff"}}}),De=function(e,t){var r=(0,n.useState)(t),u=r[0],o=r[1];return(0,n.useEffect)((function(){var t=e.subscribe(o);return function(){t.unsubscribe()}}),[]),u},Se=function(e){switch(e.key){case"ArrowUp":s(-1);break;case"ArrowDown":s(1);break;case"ArrowRight":case"ArrowLeft":case" ":case"Enter":s(0);break;case"Escape":s(1),s(-1)}},Ne=function(){return De(R,{})},_e=function(){return De(p,!1)},Ae=function(){return s(-1)},Re=function(){return s(1)},Ue=(0,ye.Z)(je)((function(){var e=function(){var e=De(pe,[]),t=De(f,0);return(0,n.useEffect)((function(){return document.body.addEventListener("keydown",Se),function(){document.body.removeEventListener("keydown",Se)}}),[]),(0,n.useMemo)((function(){var r=e.length,n=r?t%r:0;return"u">typeof localStorage&&localStorage.setItem("my:cursor",String(1+n)),[].concat((0,j.Z)(e.slice(n)),(0,j.Z)(e.slice(0,n)))}),[e,t])}(),t=_e(),r=Ne(),u=r.total,o=void 0===u?0:u,i=r.progress,c=void 0===i?0:i,a=function(e){var t=(0,n.useMemo)((function(){return e[0]||{}}),[e]),r=t.blob,u=t.preview,o=(u=void 0===u?{}:u).start,i=void 0===o?0:o,c=u.end,a=void 0===c?0:c,s=(0,n.useRef)({url:""});return{url:(0,n.useMemo)((function(){return s.current.url&&URL.revokeObjectURL(s.current.url),r?s.current.url=URL.createObjectURL(r):""}),[r]),start:i,end:a}}(e),l=a.url,p=a.start,m=a.end,v=(0,n.useCallback)((function(e){return t?e():s(1)}),[t]);return(0,d.tZ)("div",{children:(0,d.BX)(Oe.Z,{theme:t&&l?Ce:Pe,children:[(0,d.tZ)(ke.ZP,{}),(0,d.BX)(me.Z,{className:"main",children:[(0,d.BX)("header",{children:[(0,d.tZ)(ge,{show:!!o&&c<1,children:(0,d.tZ)(xe.Z,{variant:"determinate",value:Math.floor(100*c)})}),(0,d.tZ)(ge,{show:!!l,children:(0,d.tZ)(de,{src:l,start:!t&&p,end:!t&&m,onEnded:v})})]}),(0,d.tZ)("main",{children:(0,d.tZ)(Ze,{files:e})}),(0,d.BX)("footer",{children:[(0,d.tZ)(h.Z,{onClick:Ae,variant:"outlined",children:"up"}),(0,d.tZ)(h.Z,{onClick:Re,variant:"outlined",children:"down"}),(0,d.tZ)(y,{})]})]})]})})}))},5301:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return r(5283)}])}},function(e){e.O(0,[166,774,888,179],(function(){return t=5301,e(e.s=t);var t}));var t=e.O();_N_E=t}]);